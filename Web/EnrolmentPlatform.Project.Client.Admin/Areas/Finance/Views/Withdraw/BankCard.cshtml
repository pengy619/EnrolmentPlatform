
@{
    ViewBag.Title = "银行卡管理";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="main-wrap">
    <div class="panel">
        <div class="panel-title">
            <div class="layui-form">
                <div class="layui-form-item">
                    <label class="layui-form-label">公司名称</label>
                    <div class="layui-input-inline">
                        <input type="text" autocomplete="off" class="layui-input" id="txtEnterpriseName" maxlength="100">
                    </div>
                    <label class="layui-form-label">持卡人</label>
                    <div class="layui-input-inline">
                        <input type="text" autocomplete="off" class="layui-input" id="txtCardName" maxlength="100">
                    </div>
                    <label class="layui-form-label">银行卡号</label>
                    <div class="layui-input-inline">
                        <input type="text" autocomplete="off" class="layui-input" id="txtCardNumber" maxlength="100">
                    </div>
                    <button class="layui-btn layui-btn-warm" type="button" id="btnSearch">查询</button>
                </div>
            </div>
        </div>
        <div class="panel-body">
            <table id="table" lay-filter="table"></table>
        </div>
    </div>
</div>

<script src="../../framework/layui/layui.js"></script>
<script src="../../js/common.js"></script>
<script type="text/html" id="tableTool">
    <a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
</script>
<script>
    layui.use(['table', 'laydate'], function () {
        var table = layui.table;
        var laydate = layui.laydate;
        lay('.time-item').each(function () {
            laydate.render({
                elem: this
                , trigger: 'click'
            });
        });
        table.render({
            elem: '#table'
            , url: "@Url.Action("GetPageList", "Withdraw")"
            , cols: [[
                { type: 'numbers' },
                { field: 'EnterpriceTypeName', title: '公司类型', sort: true },
                { field: 'EnterpriseName', title: '公司名称', sort: true },
                { field: 'BankCardTypeName', title: '银行卡类型', sort: true },
                { field: 'CardName', title: '持卡人', sort: true },
                { field: 'CardNumber', title: '银行卡号', sort: true },
                { field: 'Bank', title: '开户银行', sort: true },
                { title: '操作', toolbar: '#tableTool' }
            ]]
            , page: true
        });
        table.on('tool(table)', function (obj) {
            var data = obj.data; //获得当前行数据
            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
            var tr = obj.tr; //获得当前行 tr 的DOM对象
            if (layEvent == 'detail') {
                location.href = "@Url.Action("BankDetail","Withdraw",new { parentId=4 })" + "&id=" + data.Id;
            }
        });
        //查询事件
        $("#btnSearch").click(function () {
            table.reload('table', {
                page: {
                    curr: 1 //重新从第 1 页开始
                }, where: {
                    EnterpriseName: $("#txtEnterpriseName").val(),
                    CardName: $("#txtCardName").val(),
                    CardNumber: $('#txtCardNumber').val()
                }
            });
        });
    });
</script>